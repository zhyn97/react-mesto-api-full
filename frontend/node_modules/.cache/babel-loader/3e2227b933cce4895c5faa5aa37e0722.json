{"ast":null,"code":"import _toConsumableArray from\"/Users/nikitaziburtovic/Desktop/yandex_praktikum/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/nikitaziburtovic/Desktop/yandex_praktikum/react-mesto-api-full/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import Header from\"./Header\";import Main from\"./Main\";import Footer from\"./Footer\";import PopupWithForm from\"./PopupWithForm\";import ImagePopup from\"./ImagePopup\";import api from\"../utils/api\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import{Route,Switch,Redirect,useHistory}from\"react-router-dom\";import Login from\"./Login\";import Register from\"./Register\";import ProtectedRoute from\"./ProtectedRoute\";import{register,authorize,checkToken}from\"../utils/auth\";import InfoTooltip from\"./InfoTooltip\";import MobileMenu from\"./MobileMenu\";import NotFound from\"./NotFound\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),cards=_React$useState2[0],setCards=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditProfilePopupOpen=_React$useState4[0],setIsEditProfilePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isEditAvatarPopupOpen=_React$useState6[0],setIsEditAvatarPopupOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isAddPlacePopupOpen=_React$useState8[0],setIsAddPlacePopupOpen=_React$useState8[1];var _React$useState9=React.useState(false),_React$useState10=_slicedToArray(_React$useState9,2),isInfoTooltipPopupOpen=_React$useState10[0],setIsInfoTooltipPopupOpen=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),isMobileMenu=_React$useState12[0],setIsMobileMenu=_React$useState12[1];var _React$useState13=React.useState(window.innerWidth),_React$useState14=_slicedToArray(_React$useState13,2),width=_React$useState14[0],setWidth=_React$useState14[1];var _React$useState15=React.useState(false),_React$useState16=_slicedToArray(_React$useState15,2),registerStatus=_React$useState16[0],setRegisterStatus=_React$useState16[1];var _React$useState17=React.useState({}),_React$useState18=_slicedToArray(_React$useState17,2),currentUser=_React$useState18[0],setCurrentUser=_React$useState18[1];var _React$useState19=React.useState({}),_React$useState20=_slicedToArray(_React$useState19,2),selectedCard=_React$useState20[0],setSelectedCard=_React$useState20[1];var _React$useState21=React.useState(false),_React$useState22=_slicedToArray(_React$useState21,2),loggedIn=_React$useState22[0],setLoggedIn=_React$useState22[1];var _React$useState23=React.useState(\"\"),_React$useState24=_slicedToArray(_React$useState23,2),email=_React$useState24[0],setEmail=_React$useState24[1];var history=useHistory();function openMobileMenu(){setIsMobileMenu(true);}function closeMobileMenu(){setIsMobileMenu(false);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function handleCardClick(card){setSelectedCard(card);}function closeAllPopups(){setIsEditProfilePopupOpen(false);setIsEditAvatarPopupOpen(false);setIsAddPlacePopupOpen(false);setIsInfoTooltipPopupOpen(false);setSelectedCard({});}function handleUpdateUser(_ref){var name=_ref.name,about=_ref.about;api.editUserData(name,about).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return console.log(err);});}function handleUpdateAvatar(_ref2){var avatar=_ref2.avatar;api.newAvatar(avatar).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return console.log(err);});}function handleAddPlaceSubmit(_ref3){var name=_ref3.name,link=_ref3.link;api.addNewCard(name,link).then(function(res){setCards([res].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){return console.log(err);});}function getCards(){api.getCards().then(function(res){setCards(res);}).catch(function(err){return console.log(err);});}function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});api.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){return console.log(err);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(c){return c._id!==card._id;});});}).catch(function(err){return console.log(err);});}function handleRegister(userData){if(!userData.email||!userData.password){return;}register(userData.email,userData.password).then(function(res){history.push(\"./sign-in\");setRegisterStatus(true);setIsInfoTooltipPopupOpen(true);}).catch(function(err){console.log(err);setRegisterStatus(false);setIsInfoTooltipPopupOpen(true);});}function handleLogin(userData){if(!userData.email||!userData.password){return;}authorize(userData.email,userData.password).then(function(data){localStorage.setItem(\"token\",data.token);setLoggedIn(true);history.push(\"/\");}).catch(function(err){return console.log(err);});}function signOut(){localStorage.removeItem(\"token\");setIsMobileMenu(false);}function handleResize(){setWidth(window.innerWidth);}React.useEffect(function(){window.addEventListener(\"resize\",handleResize);return function(){return window.removeEventListener(\"resize\",handleResize);};},[]);React.useEffect(function(){var closeByEscape=function closeByEscape(e){if(e.key===\"Escape\"){closeAllPopups();}};document.addEventListener(\"keydown\",closeByEscape);return function(){return document.removeEventListener(\"keydown\",closeByEscape);};},[]);React.useEffect(function(){if(localStorage.getItem(\"token\")){var token=localStorage.getItem(\"token\");checkToken(token).then(function(res){if(res){setEmail(res.data.email);setLoggedIn(true);history.push(\"/\");}});}},[]);React.useEffect(function(){getCards();},[]);React.useEffect(function(){api.getUserData().then(function(res){setCurrentUser(res);}).catch(function(err){return console.log(err);});},[]);return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"root\",children:[/*#__PURE__*/_jsx(MobileMenu,{signOut:signOut,isOpen:isMobileMenu,email:email}),/*#__PURE__*/_jsx(Header,{signOut:signOut,email:email,width:width,closeMobileMenu:closeMobileMenu,openMobileMenu:openMobileMenu,isMobileMenu:isMobileMenu}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsxs(ProtectedRoute,{exact:true,path:\"/\",loggedIn:loggedIn,children:[/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,cards:cards,onCardDelete:handleCardDelete,onCardLike:handleCardLike}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsx(Route,{path:\"/sign-in\",children:/*#__PURE__*/_jsx(Login,{handleLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/sign-up\",children:/*#__PURE__*/_jsx(Register,{handleRegister:handleRegister})}),/*#__PURE__*/_jsx(Route,{path:\"*\",children:/*#__PURE__*/_jsx(NotFound,{})})]}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onCardAdd:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(InfoTooltip,{isOpen:isInfoTooltipPopupOpen,onClose:closeAllPopups,TextRegisterOk:\"Вы успешно зарегистрировались!\",TextRegisterBad:\"Что-то пошло не так! Попробуйте ещё раз.\",registerStatus:registerStatus}),/*#__PURE__*/_jsx(PopupWithForm,{title:\"Вы уверены?\",name:\"popup_delete-card\",buttonText:\"Да\",onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"sources":["/Users/nikitaziburtovic/Desktop/yandex_praktikum/react-mesto-api-full/frontend/src/components/App.js"],"names":["React","Header","Main","Footer","PopupWithForm","ImagePopup","api","CurrentUserContext","EditProfilePopup","EditAvatarPopup","AddPlacePopup","Route","Switch","Redirect","useHistory","Login","Register","ProtectedRoute","register","authorize","checkToken","InfoTooltip","MobileMenu","NotFound","App","useState","cards","setCards","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isInfoTooltipPopupOpen","setIsInfoTooltipPopupOpen","isMobileMenu","setIsMobileMenu","window","innerWidth","width","setWidth","registerStatus","setRegisterStatus","currentUser","setCurrentUser","selectedCard","setSelectedCard","loggedIn","setLoggedIn","email","setEmail","history","openMobileMenu","closeMobileMenu","handleEditProfileClick","handleEditAvatarClick","handleAddPlaceClick","handleCardClick","card","closeAllPopups","handleUpdateUser","name","about","editUserData","then","res","catch","err","console","log","handleUpdateAvatar","avatar","newAvatar","handleAddPlaceSubmit","link","addNewCard","getCards","handleCardLike","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","state","map","c","handleCardDelete","deleteCard","filter","handleRegister","userData","password","push","handleLogin","data","localStorage","setItem","token","signOut","removeItem","handleResize","useEffect","addEventListener","removeEventListener","closeByEscape","e","key","document","getItem","getUserData"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport Header from \"./Header\";\nimport Main from \"./Main\";\nimport Footer from \"./Footer\";\nimport PopupWithForm from \"./PopupWithForm\";\nimport ImagePopup from \"./ImagePopup\";\nimport api from \"../utils/api\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport { Route, Switch, Redirect, useHistory } from \"react-router-dom\";\nimport Login from \"./Login\";\nimport Register from \"./Register\";\nimport ProtectedRoute from \"./ProtectedRoute\";\nimport { register, authorize, checkToken } from \"../utils/auth\";\nimport InfoTooltip from \"./InfoTooltip\";\nimport MobileMenu from \"./MobileMenu\";\nimport NotFound from \"./NotFound\";\n\nfunction App() {\n  const [cards, setCards] = React.useState([]);\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] =\n    React.useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] =\n    React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [isInfoTooltipPopupOpen, setIsInfoTooltipPopupOpen] =\n    React.useState(false);\n  const [isMobileMenu, setIsMobileMenu] = React.useState(false)\n  const [width, setWidth] = React.useState(window.innerWidth);\n  const [registerStatus, setRegisterStatus] = React.useState(false);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  const [email, setEmail] = React.useState(\"\");\n  const history = useHistory();\n\n\n  function openMobileMenu() {\n    setIsMobileMenu(true);\n  }\n\n  function closeMobileMenu() {\n    setIsMobileMenu(false);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function closeAllPopups() {\n    setIsEditProfilePopupOpen(false);\n    setIsEditAvatarPopupOpen(false);\n    setIsAddPlacePopupOpen(false);\n    setIsInfoTooltipPopupOpen(false);\n    setSelectedCard({});\n  }\n\n  function handleUpdateUser({ name, about }) {\n    api\n      .editUserData(name, about)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleUpdateAvatar({ avatar }) {\n    api\n      .newAvatar(avatar)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleAddPlaceSubmit({ name, link }) {\n    api\n      .addNewCard(name, link)\n      .then((res) => {\n        setCards([res, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function getCards() {\n    api\n      .getCards()\n      .then((res) => {\n        setCards(res);\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleCardLike(card) {\n    const isLiked = card.likes.some((i) => i._id === currentUser._id);\n\n    api\n      .changeLikeCardStatus(card._id, !isLiked)\n      .then((newCard) => {\n        setCards((state) =>\n          state.map((c) => (c._id === card._id ? newCard : c))\n        );\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleCardDelete(card) {\n    api\n      .deleteCard(card._id)\n      .then(() => {\n        setCards((state) => state.filter((c) => c._id !== card._id));\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleRegister(userData) {\n    if (!userData.email || !userData.password) {\n      return;\n    }\n    register(userData.email, userData.password)\n      .then((res) => {\n        history.push(\"./sign-in\");\n        setRegisterStatus(true);\n        setIsInfoTooltipPopupOpen(true);\n      })\n      .catch((err) => {\n        console.log(err);\n        setRegisterStatus(false);\n        setIsInfoTooltipPopupOpen(true);\n      });\n  }\n\n  function handleLogin(userData) {\n    if (!userData.email || !userData.password) {\n      return;\n    }\n    authorize(userData.email, userData.password)\n      .then((data) => {\n        localStorage.setItem(\"token\", data.token);\n        setLoggedIn(true);\n        history.push(\"/\");\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function signOut() {\n    localStorage.removeItem(\"token\");\n    setIsMobileMenu(false);\n  }\n\n  function handleResize() {\n    setWidth(window.innerWidth);\n  }\n\n  React.useEffect(() => {\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  React.useEffect(() => {\n    const closeByEscape = (e) => {\n      if (e.key === \"Escape\") {\n        closeAllPopups();\n      }\n    };\n\n    document.addEventListener(\"keydown\", closeByEscape);\n\n    return () => document.removeEventListener(\"keydown\", closeByEscape);\n  }, []);\n\n  React.useEffect(() => {\n    if (localStorage.getItem(\"token\")) {\n      const token = localStorage.getItem(\"token\");\n      checkToken(token).then((res) => {\n        if (res) {\n          setEmail(res.data.email);\n          setLoggedIn(true);\n          history.push(\"/\");\n        }\n      });\n    }\n  }, []);\n\n  React.useEffect(() => {\n    getCards();\n  }, []);\n\n  React.useEffect(() => {\n    api\n      .getUserData()\n      .then((res) => {\n        setCurrentUser(res);\n      })\n      .catch((err) => console.log(err));\n  }, []);\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"root\">\n        <MobileMenu signOut={signOut} isOpen={isMobileMenu} email={email} />\n        <Header signOut={signOut} email={email} width={width} closeMobileMenu={closeMobileMenu} openMobileMenu={openMobileMenu} isMobileMenu={isMobileMenu} />\n\n        <Switch>\n          <ProtectedRoute exact path=\"/\" loggedIn={loggedIn}>\n            <Main\n              onEditProfile={handleEditProfileClick}\n              onAddPlace={handleAddPlaceClick}\n              onEditAvatar={handleEditAvatarClick}\n              onCardClick={handleCardClick}\n              cards={cards}\n              onCardDelete={handleCardDelete}\n              onCardLike={handleCardLike}\n            />\n            <Footer />\n          </ProtectedRoute>\n\n          <Route path=\"/sign-in\">\n            <Login handleLogin={handleLogin} />\n          </Route>\n\n          <Route path=\"/sign-up\">\n            <Register handleRegister={handleRegister} />\n          </Route>\n\n          <Route path=\"*\">\n            <NotFound />\n          </Route>\n        </Switch>\n\n        <ImagePopup card={selectedCard} onClose={closeAllPopups} />\n\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n        />\n\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n        />\n\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onCardAdd={handleAddPlaceSubmit}\n        />\n\n        <InfoTooltip\n          isOpen={isInfoTooltipPopupOpen}\n          onClose={closeAllPopups}\n          TextRegisterOk={\"Вы успешно зарегистрировались!\"}\n          TextRegisterBad={\"Что-то пошло не так! Попробуйте ещё раз.\"}\n          registerStatus={registerStatus}\n        />\n\n        <PopupWithForm\n          title={\"Вы уверены?\"}\n          name={\"popup_delete-card\"}\n          buttonText={\"Да\"}\n          onClose={closeAllPopups}\n        />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}